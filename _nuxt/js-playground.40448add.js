import{_ as q}from"./client-only.fead6ff0.js";import{u as X}from"./useDttkMeta.17da516d.js";import{u as Y}from"./useEmitter.43e253ae.js";import{d as Z,r as P,G as ee,o as te,i as w,x as j,A as l,B as c,L as v,M as ne,y as N,P as oe,S as le,v as D,C as $,J,K as M,O as E,Q as F,T as L,U as I,V as ae,W as se,z as ce}from"./entry.cc54ff89.js";const K={crush:(r,b=50)=>{const h="",d=(n,u)=>{let k=u.length,O="";const R=t=>encodeURI(encodeURIComponent(t)).replace(/%../g,"i").length,A=t=>{let e=t.charCodeAt(0),o=t.charCodeAt(t.length-1);return e>=56320&&e<=57343||o>=55296&&o<=56319};let S={};for(let t=2;t<b;t++)for(let e=0;e<n.length-t;++e){let o=n.substr(e,t);if(S[o]||A(o))continue;let p=1;for(let m=n.indexOf(o,e+t);m>=0;++p)m=n.indexOf(o,m+t);p>1&&(S[o]=p)}for(;;){for(;k--&&n.includes(u[k]););if(k<0)break;let t=u[k],e,o=0,p=R(t);for(let a in S){let C=S[a],_=(C-1)*R(a)-(C+1)*p;O.length||(_-=R(h)),_<=0?delete S[a]:_>o&&(e=a,o=_)}if(!e)break;n=n.split(e).join(t)+t+e,O=t+O;let m={};for(let a in S){let C=a.split(e).join(t),_=0;for(let U=n.indexOf(C);U>=0;++_)U=n.indexOf(C,U+C.length);_>1&&(m[C]=_)}S=m}return{a:n,b:O}};let s=[];const i="-_.!~*'()";for(let n=127;--n;)(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||i.includes(String.fromCharCode(n)))&&s.push(String.fromCharCode(n));for(let n=32;n<255;++n){let u=String.fromCharCode(n);u!="\\"&&!s.includes(u)&&s.unshift(u)}r=r.replace(new RegExp(h,"g"),""),r=T(r);const y=d(r,s);let g=y.a;return y.b.length&&(g+=h+y.b),g+="_",g},uncrush:r=>{r=r.substring(0,r.length-1);const b=r.split("");let h=b[0];if(b.length>1){let d=b[1];for(let s of d){let i=h.split(s);h=i.join(i.pop())}}return T(h,0)}},T=(r,b=1)=>{const h=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],d=(s,i)=>{let y=new RegExp(`${(i[2]?i[2]:"")+i[0]}|${(i[3]?i[3]:"")+i[1]}`,"g");return s.replace(y,g=>g===i[0]?i[1]:i[0])};if(b)for(let s=0;s<h.length;++s)r=d(r,h[s]);else for(let s=h.length;s--;)r=d(r,h[s]);return r},re={class:"d-flex align-center"},ie={style:{height:"200px"}},ue={class:"my-3"},ve=Z({__name:"js-playground",setup(r){X({title:"JavaScript Playground",description:"A playground for JavaScript",path:"/js-playground"});const b=Y(),h={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},d=P([]),s=new Map,i=Object.freeze({name:"",code:"",readonly:!1}),y=ee([{...i,id:0}]),g=P([0]);function n(){const t=Date.now();y.push({...i,id:t}),g.value.push(t)}const u=P(""),k=P(!1),O=P(0);async function R(){k.value=!0,u.value="",O.value=0;const t=d.value.filter(a=>a.length!==0),e=[];try{e.push(...await Promise.all(t.map(async a=>{if(s.has(a))return s.get(a);u.value+=`Loading ${a}...
`;const _=await(await fetch(a)).text();return s.set(a,_),_})))}catch(a){u.value+=`${a}`,k.value=!1;return}u.value="";const o=e.concat(y.map(a=>a.code)).join(`
`),p=Object.getPrototypeOf(async function(){}).constructor,m=new p(o);await A(m),k.value=!1}async function A(t){const e=console.log;console.log=(...p)=>{u.value+=p.join(" ")+`
`};const o=performance.now();try{await t()}catch(p){u.value+=`${p}`}O.value=performance.now()-o,console.log=e}function S(){const t=new URL(window.location.href),e={dependencies:[...d.value],cells:y.map(p=>({...p})),panels:[...g.value]},o=encodeURIComponent(K.crush(JSON.stringify(e)));return t.searchParams.set("crushed",o),t.href}return te(()=>{const e=new URL(window.location.href).searchParams.get("crushed");if(e)try{const o=JSON.parse(K.uncrush(decodeURIComponent(e)));d.value=o.dependencies,y.splice(0,y.length,...o.cells),g.value=o.panels}catch(o){console.log(o)}}),(t,e)=>{const o=w("v-expansion-panel-title"),p=w("v-text-field"),m=w("v-btn"),a=w("v-tooltip"),C=w("v-expansion-panel-text"),_=w("v-expansion-panel"),U=w("v-expansion-panels"),z=w("v-spacer"),G=w("v-checkbox"),B=q,H=w("v-card-text"),Q=w("v-card");return D(),j("div",null,[l(U,{class:"my-3"},{default:c(()=>[l(_,null,{default:c(()=>[l(o,{ripple:""},{default:c(()=>[$(" Dependencies ")]),_:1}),l(C,null,{default:c(()=>[(D(!0),j(J,null,M(v(d),(f,V)=>(D(),j("div",re,[(D(),E(p,{key:V,variant:"solo","hide-details":"",label:"CDN URL",placeholder:"https://cdn.jsdelivr.net/npm/package@version/file",class:"flex-grow-1",modelValue:v(d)[V],"onUpdate:modelValue":x=>v(d)[V]=x},null,8,["modelValue","onUpdate:modelValue"])),l(a,{text:"Delete",location:"top"},{activator:c(({props:x})=>[l(m,F(x,{variant:"plain",icon:"mdi-close",onClick:W=>v(d).splice(V,1)}),null,16,["onClick"])]),_:2},1024)]))),256)),l(m,{onClick:e[0]||(e[0]=f=>v(d).push("")),"prepend-icon":"mdi-plus",text:"Add",class:"my-3",block:""})]),_:1})]),_:1})]),_:1}),l(U,{multiple:"",modelValue:v(g),"onUpdate:modelValue":e[5]||(e[5]=f=>ne(g)?g.value=f:null)},{default:c(()=>[(D(!0),j(J,null,M(v(y),(f,V)=>(D(),E(_,{key:f.id,value:f.id},{default:c(()=>[l(o,{ripple:"",class:"py-2"},{default:c(()=>[l(p,{variant:"solo",onClick:e[1]||(e[1]=L(()=>{},["stop"])),onKeyup:e[2]||(e[2]=I(L(()=>{},["prevent","stop"]),["space"])),onKeydown:I(L(x=>f.name+=" ",["prevent","stop"]),["space"]),"hide-details":"",placeholder:"Cell Name",density:"compact",modelValue:f.name,"onUpdate:modelValue":x=>f.name=x,style:{"max-width":"500px"}},null,8,["onKeydown","modelValue","onUpdate:modelValue"]),l(z),l(G,{modelValue:f.readonly,"onUpdate:modelValue":x=>f.readonly=x,onClick:e[4]||(e[4]=L(()=>{},["stop"])),"hide-details":"",density:"compact",class:"flex-grow-0 ml-3"},{label:c(()=>[N("div",{onClick:e[3]||(e[3]=L(()=>{},["stop"]))},"Readonly")]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(B,null,{default:c(()=>[l(a,{text:"Delete Cell",location:"top"},{activator:c(({props:x})=>[l(m,F(x,{variant:"plain",icon:"mdi-close",onClick:L(W=>v(y).splice(V,1),["stop"]),class:"ml-3",style:{height:"40px"}}),null,16,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),l(C,null,{default:c(()=>[N("div",ie,[l(B,null,{default:c(()=>[l(v(ae),{value:f.code,"onUpdate:value":x=>f.code=x,theme:"vs-dark",options:{...h,readOnly:f.readonly},language:"javascript",class:"my-3"},null,8,["value","onUpdate:value","options"])]),_:2},1024)])]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),N("div",ue,[l(m,{onClick:n,"prepend-icon":"mdi-plus"},{default:c(()=>[$(" Add Cell ")]),_:1}),l(m,{"prepend-icon":"mdi-play",class:"mx-3",onClick:R,loading:v(k)},{default:c(()=>[$(" Execute ")]),_:1},8,["loading"]),l(m,{"prepend-icon":"mdi-share",onClick:e[6]||(e[6]=f=>{v(se)(S()),v(b).emit("toast","Copied")})},{default:c(()=>[$(" Copy Sharing URL ")]),_:1})]),oe(l(Q,{title:`Output (${v(O)}ms)`,class:"my-3"},{default:c(()=>[l(H,null,{default:c(()=>[N("pre",null,ce(v(u)),1)]),_:1})]),_:1},8,["title"]),[[le,v(u).length!==0]])])}}});export{ve as default};
