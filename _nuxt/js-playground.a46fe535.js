import{_ as X}from"./client-only.42af70f1.js";import{u as q}from"./useDttkMeta.84ba9d19.js";import{u as Y}from"./useEmitter.43e253ae.js";import{d as Z,r as P,G as ee,o as te,i as w,x as $,A as l,B as c,L as h,M as ne,y as j,P as oe,S as le,v as D,C as N,J,K as M,O as E,Q as F,T as L,U as I,V as ae,W as se,X as ce,z as re}from"./entry.8a845c13.js";const K={crush:(r,b=50)=>{const v="",m=(n,u)=>{let S=u.length,O="";const R=t=>encodeURI(encodeURIComponent(t)).replace(/%../g,"i").length,A=t=>{let e=t.charCodeAt(0),o=t.charCodeAt(t.length-1);return e>=56320&&e<=57343||o>=55296&&o<=56319};let k={};for(let t=2;t<b;t++)for(let e=0;e<n.length-t;++e){let o=n.substr(e,t);if(k[o]||A(o))continue;let p=1;for(let f=n.indexOf(o,e+t);f>=0;++p)f=n.indexOf(o,f+t);p>1&&(k[o]=p)}for(;;){for(;S--&&n.includes(u[S]););if(S<0)break;let t=u[S],e,o=0,p=R(t);for(let a in k){let C=k[a],_=(C-1)*R(a)-(C+1)*p;O.length||(_-=R(v)),_<=0?delete k[a]:_>o&&(e=a,o=_)}if(!e)break;n=n.split(e).join(t)+t+e,O=t+O;let f={};for(let a in k){let C=a.split(e).join(t),_=0;for(let U=n.indexOf(C);U>=0;++_)U=n.indexOf(C,U+C.length);_>1&&(f[C]=_)}k=f}return{a:n,b:O}};let s=[];const i="-_.!~*'()";for(let n=127;--n;)(n>=48&&n<=57||n>=65&&n<=90||n>=97&&n<=122||i.includes(String.fromCharCode(n)))&&s.push(String.fromCharCode(n));for(let n=32;n<255;++n){let u=String.fromCharCode(n);u!="\\"&&!s.includes(u)&&s.unshift(u)}r=r.replace(new RegExp(v,"g"),""),r=T(r);const y=m(r,s);let g=y.a;return y.b.length&&(g+=v+y.b),g+="_",g},uncrush:r=>{r=r.substring(0,r.length-1);const b=r.split("");let v=b[0];if(b.length>1){let m=b[1];for(let s of m){let i=v.split(s);v=i.join(i.pop())}}return T(v,0)}},T=(r,b=1)=>{const v=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],m=(s,i)=>{let y=new RegExp(`${(i[2]?i[2]:"")+i[0]}|${(i[3]?i[3]:"")+i[1]}`,"g");return s.replace(y,g=>g===i[0]?i[1]:i[0])};if(b)for(let s=0;s<v.length;++s)r=m(r,v[s]);else for(let s=v.length;s--;)r=m(r,v[s]);return r},ie={class:"d-flex align-center"},ue={class:"my-3"},he=Z({__name:"js-playground",setup(r){q({title:"JavaScript Playground",description:"A playground for JavaScript",path:"/js-playground"});const b=Y(),v={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},m=P([]),s=new Map,i=Object.freeze({name:"",code:"",readonly:!1}),y=ee([{...i,id:0}]),g=P([0]);function n(){const t=Date.now();y.push({...i,id:t}),g.value.push(t)}const u=P(""),S=P(!1),O=P(0);async function R(){S.value=!0,u.value="",O.value=0;const t=m.value.filter(a=>a.length!==0),e=[];try{e.push(...await Promise.all(t.map(async a=>{if(s.has(a))return s.get(a);u.value+=`Loading ${a}...
`;const _=await(await fetch(a)).text();return s.set(a,_),_})))}catch(a){u.value+=`${a}`,S.value=!1;return}u.value="";const o=e.concat(y.map(a=>a.code)).join(`
`),p=Object.getPrototypeOf(async function(){}).constructor,f=new p(o);await A(f),S.value=!1}async function A(t){const e=console.log;console.log=(...p)=>{u.value+=p.join(" ")+`
`};const o=performance.now();try{await t()}catch(p){u.value+=`${p}`}O.value=performance.now()-o,console.log=e}function k(){const t=new URL(window.location.href),e={dependencies:[...m.value],cells:y.map(p=>({...p})),panels:[...g.value]},o=encodeURIComponent(K.crush(JSON.stringify(e)));return t.searchParams.set("crushed",o),t.href}return te(()=>{const e=new URL(window.location.href).searchParams.get("crushed");if(e)try{const o=JSON.parse(K.uncrush(decodeURIComponent(e)));m.value=o.dependencies,y.splice(0,y.length,...o.cells),g.value=o.panels}catch(o){console.log(o)}}),(t,e)=>{const o=w("v-expansion-panel-title"),p=w("v-text-field"),f=w("v-btn"),a=w("v-tooltip"),C=w("v-expansion-panel-text"),_=w("v-expansion-panel"),U=w("v-expansion-panels"),z=w("v-spacer"),G=w("v-checkbox"),B=X,H=w("v-card-text"),Q=w("v-card");return D(),$("div",null,[l(U,{class:"my-3"},{default:c(()=>[l(_,null,{default:c(()=>[l(o,{ripple:""},{default:c(()=>[N(" Dependencies ")]),_:1}),l(C,null,{default:c(()=>[(D(!0),$(J,null,M(h(m),(d,V)=>(D(),$("div",ie,[(D(),E(p,{key:V,variant:"solo","hide-details":"",label:"CDN URL",placeholder:"https://cdn.jsdelivr.net/npm/package@version/file",class:"flex-grow-1",modelValue:h(m)[V],"onUpdate:modelValue":x=>h(m)[V]=x},null,8,["modelValue","onUpdate:modelValue"])),l(a,{text:"Delete",location:"top"},{activator:c(({props:x})=>[l(f,F(x,{variant:"plain",icon:"mdi-close",onClick:W=>h(m).splice(V,1)}),null,16,["onClick"])]),_:2},1024)]))),256)),l(f,{onClick:e[0]||(e[0]=d=>h(m).push("")),"prepend-icon":"mdi-plus",text:"Add",class:"my-3",block:""})]),_:1})]),_:1})]),_:1}),l(U,{multiple:"",modelValue:h(g),"onUpdate:modelValue":e[5]||(e[5]=d=>ne(g)?g.value=d:null)},{default:c(()=>[(D(!0),$(J,null,M(h(y),(d,V)=>(D(),E(_,{key:d.id,value:d.id},{default:c(()=>[l(o,{ripple:"",class:"py-2"},{default:c(()=>[l(p,{variant:"solo",onClick:e[1]||(e[1]=L(()=>{},["stop"])),onKeyup:e[2]||(e[2]=I(L(()=>{},["prevent","stop"]),["space"])),onKeydown:I(L(x=>d.name+=" ",["prevent","stop"]),["space"]),"hide-details":"",placeholder:"Cell Name",density:"compact",modelValue:d.name,"onUpdate:modelValue":x=>d.name=x,style:{"max-width":"500px"}},null,8,["onKeydown","modelValue","onUpdate:modelValue"]),l(z),l(G,{modelValue:d.readonly,"onUpdate:modelValue":x=>d.readonly=x,onClick:e[4]||(e[4]=L(()=>{},["stop"])),"hide-details":"",density:"compact",class:"flex-grow-0 ml-3"},{label:c(()=>[j("div",{onClick:e[3]||(e[3]=L(()=>{},["stop"]))},"Readonly")]),_:2},1032,["modelValue","onUpdate:modelValue"]),l(B,null,{default:c(()=>[l(a,{text:"Delete Cell",location:"top"},{activator:c(({props:x})=>[l(f,F(x,{variant:"plain",icon:"mdi-close",onClick:L(W=>h(y).splice(V,1),["stop"]),class:"ml-3",style:{height:"40px"}}),null,16,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),l(C,null,{default:c(()=>[j("div",{style:se(`
            min-height: 200px;
            height: ${d.code.split(`
`).length*19}px;
            max-height: 80vh;
            `)},[l(B,null,{default:c(()=>[l(h(ae),{value:d.code,"onUpdate:value":x=>d.code=x,theme:"vs-dark",options:{...v,readOnly:d.readonly},language:"javascript",class:"my-3"},null,8,["value","onUpdate:value","options"])]),_:2},1024)],4)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),j("div",ue,[l(f,{onClick:n,"prepend-icon":"mdi-plus"},{default:c(()=>[N(" Add Cell ")]),_:1}),l(f,{"prepend-icon":"mdi-play",class:"mx-3",onClick:R,loading:h(S)},{default:c(()=>[N(" Execute ")]),_:1},8,["loading"]),l(f,{"prepend-icon":"mdi-share",onClick:e[6]||(e[6]=d=>{h(ce)(k()),h(b).emit("toast","Copied")})},{default:c(()=>[N(" Copy Sharing URL ")]),_:1})]),oe(l(Q,{title:`Output (${h(O)}ms)`,class:"my-3"},{default:c(()=>[l(H,null,{default:c(()=>[j("pre",null,re(h(u)),1)]),_:1})]),_:1},8,["title"]),[[le,h(u).length!==0]])])}}});export{he as default};
