import{_ as X}from"./client-only.18ff6a64.js";import{u as q}from"./useDttkMeta.67acf2d1.js";import{u as Y}from"./useEmitter.43e253ae.js";import{d as Z,r as $,G as ee,o as te,i as C,x as P,A as a,B as c,L as f,M as ne,y as j,P as oe,S as le,v as D,C as N,J,K as M,O as E,Q as F,T as L,U as I,V as ae,W as se,X as ce,z as re}from"./entry.af5c103e.js";const K={crush:(r,b=50)=>{const h="",m=(o,u)=>{let S=u.length,O="";const R=t=>encodeURI(encodeURIComponent(t)).replace(/%../g,"i").length,A=t=>{let e=t.charCodeAt(0),l=t.charCodeAt(t.length-1);return e>=56320&&e<=57343||l>=55296&&l<=56319};let k={};for(let t=2;t<b;t++)for(let e=0;e<o.length-t;++e){let l=o.substr(e,t);if(k[l]||A(l))continue;let p=1;for(let n=o.indexOf(l,e+t);n>=0;++p)n=o.indexOf(l,n+t);p>1&&(k[l]=p)}for(;;){for(;S--&&o.includes(u[S]););if(S<0)break;let t=u[S],e,l=0,p=R(t);for(let w in k){let _=k[w],x=(_-1)*R(w)-(_+1)*p;O.length||(x-=R(h)),x<=0?delete k[w]:x>l&&(e=w,l=x)}if(!e)break;o=o.split(e).join(t)+t+e,O=t+O;let n={};for(let w in k){let _=w.split(e).join(t),x=0;for(let U=o.indexOf(_);U>=0;++x)U=o.indexOf(_,U+_.length);x>1&&(n[_]=x)}k=n}return{a:o,b:O}};let s=[];const i="-_.!~*'()";for(let o=127;--o;)(o>=48&&o<=57||o>=65&&o<=90||o>=97&&o<=122||i.includes(String.fromCharCode(o)))&&s.push(String.fromCharCode(o));for(let o=32;o<255;++o){let u=String.fromCharCode(o);u!="\\"&&!s.includes(u)&&s.unshift(u)}r=r.replace(new RegExp(h,"g"),""),r=T(r);const v=m(r,s);let y=v.a;return v.b.length&&(y+=h+v.b),y+="_",y},uncrush:r=>{r=r.substring(0,r.length-1);const b=r.split("");let h=b[0];if(b.length>1){let m=b[1];for(let s of m){let i=h.split(s);h=i.join(i.pop())}}return T(h,0)}},T=(r,b=1)=>{const h=[['"',"'"],["':","!"],[",'","~"],["}",")","\\","\\"],["{","(","\\","\\"]],m=(s,i)=>{let v=new RegExp(`${(i[2]?i[2]:"")+i[0]}|${(i[3]?i[3]:"")+i[1]}`,"g");return s.replace(v,y=>y===i[0]?i[1]:i[0])};if(b)for(let s=0;s<h.length;++s)r=m(r,h[s]);else for(let s=h.length;s--;)r=m(r,h[s]);return r},ie={class:"d-flex align-center"},ue={class:"my-3"},he=Z({__name:"js-playground",setup(r){q({title:"JavaScript Playground",description:"A playground for JavaScript",path:"/js-playground"});const b=Y(),h={automaticLayout:!0,formatOnType:!0,formatOnPaste:!0},m=$([]),s=new Map,i=Object.freeze({name:"",code:"",readonly:!1}),v=ee([{...i,id:0}]),y=$([0]);function o(){const t=Date.now();v.push({...i,id:t}),y.value.push(t)}const u=$(""),S=$(!1),O=$(0);async function R(){S.value=!0,u.value="",O.value=0;const t=m.value.filter(n=>n.length!==0),e=[];try{e.push(...await Promise.all(t.map(async n=>{if(s.has(n))return s.get(n);u.value+=`Loading ${n}...
`;const _=await(await fetch(n)).text();return s.set(n,_),_})))}catch(n){u.value+=`${n}`,S.value=!1;return}u.value="";const l=e.concat(v.map(n=>n.code)).join(`
`),p=Object.getPrototypeOf(async function(){}).constructor;try{await A(new p(l))}catch(n){u.value+=`${n}`}finally{S.value=!1}}async function A(t){const e=console.log;console.log=(...p)=>{u.value+=p.join(" ")+`
`};const l=performance.now();try{await t()}catch(p){u.value+=`${p}`}O.value=performance.now()-l,console.log=e}function k(){const t=new URL(window.location.href),e={dependencies:[...m.value],cells:v.map(p=>({...p})),panels:[...y.value]},l=encodeURIComponent(K.crush(JSON.stringify(e)));return t.searchParams.set("crushed",l),t.href}return te(()=>{const e=new URL(window.location.href).searchParams.get("crushed");if(e)try{const l=JSON.parse(K.uncrush(decodeURIComponent(e)));m.value=l.dependencies,v.splice(0,v.length,...l.cells),y.value=l.panels}catch(l){console.log(l)}}),(t,e)=>{const l=C("v-expansion-panel-title"),p=C("v-text-field"),n=C("v-btn"),w=C("v-tooltip"),_=C("v-expansion-panel-text"),x=C("v-expansion-panel"),U=C("v-expansion-panels"),z=C("v-spacer"),G=C("v-checkbox"),B=X,H=C("v-card-text"),Q=C("v-card");return D(),P("div",null,[a(U,{class:"my-3"},{default:c(()=>[a(x,null,{default:c(()=>[a(l,{ripple:""},{default:c(()=>[N(" Dependencies ")]),_:1}),a(_,null,{default:c(()=>[(D(!0),P(J,null,M(f(m),(d,V)=>(D(),P("div",ie,[(D(),E(p,{key:V,variant:"solo","hide-details":"",label:"CDN URL",placeholder:"https://cdn.jsdelivr.net/npm/package@version/file",class:"flex-grow-1",modelValue:f(m)[V],"onUpdate:modelValue":g=>f(m)[V]=g},null,8,["modelValue","onUpdate:modelValue"])),a(w,{text:"Delete",location:"top"},{activator:c(({props:g})=>[a(n,F(g,{variant:"plain",icon:"mdi-close",onClick:W=>f(m).splice(V,1)}),null,16,["onClick"])]),_:2},1024)]))),256)),a(n,{onClick:e[0]||(e[0]=d=>f(m).push("")),"prepend-icon":"mdi-plus",text:"Add",class:"my-3",block:""})]),_:1})]),_:1})]),_:1}),a(U,{multiple:"",modelValue:f(y),"onUpdate:modelValue":e[5]||(e[5]=d=>ne(y)?y.value=d:null)},{default:c(()=>[(D(!0),P(J,null,M(f(v),(d,V)=>(D(),E(x,{key:d.id,value:d.id},{default:c(()=>[a(l,{ripple:"",class:"py-2"},{default:c(()=>[a(p,{variant:"solo",onClick:e[1]||(e[1]=L(()=>{},["stop"])),onKeyup:e[2]||(e[2]=I(L(()=>{},["prevent","stop"]),["space"])),onKeydown:I(L(g=>d.name+=" ",["prevent","stop"]),["space"]),"hide-details":"",placeholder:"Cell Name",density:"compact",modelValue:d.name,"onUpdate:modelValue":g=>d.name=g,style:{"max-width":"500px"}},null,8,["onKeydown","modelValue","onUpdate:modelValue"]),a(z),a(G,{modelValue:d.readonly,"onUpdate:modelValue":g=>d.readonly=g,onClick:e[4]||(e[4]=L(()=>{},["stop"])),"hide-details":"",density:"compact",class:"flex-grow-0 ml-3"},{label:c(()=>[j("div",{onClick:e[3]||(e[3]=L(()=>{},["stop"]))},"Readonly")]),_:2},1032,["modelValue","onUpdate:modelValue"]),a(B,null,{default:c(()=>[a(w,{text:"Delete Cell",location:"top"},{activator:c(({props:g})=>[a(n,F(g,{variant:"plain",icon:"mdi-close",onClick:L(W=>f(v).splice(V,1),["stop"]),class:"ml-3",style:{height:"40px"}}),null,16,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024),a(_,null,{default:c(()=>[j("div",{style:se(`
            min-height: 200px;
            height: ${d.code.split(`
`).length*19}px;
            max-height: 80vh;
            `)},[a(B,null,{default:c(()=>[a(f(ae),{value:d.code,"onUpdate:value":g=>d.code=g,theme:"vs-dark",options:{...h,readOnly:d.readonly},language:"javascript",class:"my-3"},null,8,["value","onUpdate:value","options"])]),_:2},1024)],4)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"]),j("div",ue,[a(n,{onClick:o,"prepend-icon":"mdi-plus"},{default:c(()=>[N(" Add Cell ")]),_:1}),a(n,{"prepend-icon":"mdi-play",class:"mx-3",onClick:R,loading:f(S)},{default:c(()=>[N(" Execute ")]),_:1},8,["loading"]),a(n,{"prepend-icon":"mdi-share",onClick:e[6]||(e[6]=d=>{f(ce)(k()),f(b).emit("toast","Copied")})},{default:c(()=>[N(" Copy Sharing URL ")]),_:1})]),oe(a(Q,{title:`Output (${f(O)}ms)`,class:"my-3"},{default:c(()=>[a(H,null,{default:c(()=>[j("pre",null,re(f(u)),1)]),_:1})]),_:1},8,["title"]),[[le,f(u).length!==0]])])}}});export{he as default};
