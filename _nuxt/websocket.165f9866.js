import{u as M}from"./useEmitter.43e253ae.js";import{d as R,F as P,r as u,i as r,I as $,x as w,y as _,A as n,L as t,M as g,N as U,Y as N,B as c,U as H,T as I,J,K as O,v as m,Q as k,O as h,R as B,P as Q,C as F,z as L}from"./entry.84b90e13.js";const W={class:"d-flex flex-wrap"},Y={class:"d-flex flex-wrap"},j={class:"d-flex flex-grow-1 align-end"},q=_("div",{class:"flex-grow-1"},null,-1),ee=R({__name:"websocket",setup(G){const C=M(),y=P(),p=u("ws://localhost:8080"),f=u(""),a=u(!1),l=u(null),d=u(""),i=u([]);function T(){a.value=!0,l.value!=null&&l.value.close(),l.value=new WebSocket(p.value,f.value.split(",").map(s=>s.trim()).filter(s=>s!="")),l.value.onopen=()=>{a.value=!1,i.value.unshift({time:new Date,from:"system",type:"text",content:"Connected"})},l.value.onclose=()=>{l.value=null,a.value=!1,i.value.unshift({time:new Date,from:"system",type:"text",content:"Disconnected"})},l.value.onmessage=s=>{i.value.unshift({time:new Date,from:"server",type:"text",content:s.data})},l.value.onerror=s=>{l.value=null,a.value=!1,i.value.unshift({time:new Date,from:"system",type:"error",content:s.toString()})}}function V(){if(l.value==null){C.emit("toast","Not connected");return}l.value.send(d.value),i.value.unshift({time:new Date,from:"client",type:"text",content:d.value}),d.value=""}return(s,o)=>{const D=r("v-text-field"),v=r("v-btn"),x=r("v-tooltip"),A=r("v-textarea"),K=r("v-card-text"),z=r("v-card-subtitle"),E=r("v-card"),S=$("clipboard");return m(),w("div",null,[_("div",W,[n(D,{label:"Server URL",modelValue:t(p),"onUpdate:modelValue":o[0]||(o[0]=e=>g(p)?p.value=e:null),variant:"outlined",density:"compact",clearable:"","hide-details":"",placeholder:"ws://localhost:8080",disabled:t(a)||t(l)!=null,class:U(t(y).smAndUp.value?"mr-3":"mb-3"),style:N(t(y).smAndUp.value?"":"width:100%")},null,8,["modelValue","disabled","class","style"]),n(D,{label:"Subprotocols (optional, comma separated)",modelValue:t(f),"onUpdate:modelValue":o[1]||(o[1]=e=>g(f)?f.value=e:null),variant:"outlined",density:"compact",clearable:"","hide-details":"",placeholder:"ship, done",disabled:t(a)||t(l)!=null,class:U(t(y).smAndUp.value?"mr-3":"")},null,8,["modelValue","disabled","class"])]),n(v,{onClick:o[2]||(o[2]=e=>t(l)==null?T():t(l).close()),disabled:t(a),block:"",class:"my-2","prepend-icon":t(l)==null?"mdi-link-variant":"mdi-link-variant-off",text:t(l)==null?"Connect":"Disconnect",loading:t(a)},null,8,["disabled","prepend-icon","text","loading"]),n(A,{label:"",rows:"1",modelValue:t(d),"onUpdate:modelValue":o[3]||(o[3]=e=>g(d)?d.value=e:null),"auto-grow":"",variant:"outlined",density:"compact",clearable:"","hide-details":"",disabled:t(l)==null,onKeyup:H(I(V,["ctrl"]),["enter"]),placeholder:"Type message here"},{"append-inner":c(()=>[n(x,{text:"Send (Ctrl+Enter)",location:"top"},{activator:c(({props:e})=>[n(v,k(e,{icon:"mdi-send",variant:"plain",onClick:V}),null,16)]),_:1})]),_:1},8,["modelValue","disabled","onKeyup"]),n(v,{onClick:o[4]||(o[4]=e=>t(i).length=0),block:"",class:"my-2","prepend-icon":"mdi-delete-outline",text:"Clear History"}),(m(!0),w(J,null,O(t(i),e=>(m(),w("div",{key:e.time.getTime(),class:"my-2 d-flex"},[e.from=="server"||e.from=="system"?(m(),h(x,{key:0,text:e.from=="server"?"From Server":"From System",location:"top"},{activator:c(({props:b})=>[n(v,k(b,{variant:"plain",icon:e.from=="server"?"mdi-arrow-bottom-right-thick":"mdi-account"}),null,16,["icon"])]),_:2},1032,["text"])):B("",!0),Q((m(),h(E,{class:"flex-grow-1",onClick:o[5]||(o[5]=()=>{})},{default:c(()=>[_("div",Y,[n(K,{style:N([e.type=="error"?"color:red":void 0,{"word-break":"break-all","white-space":"pre","font-family":"monospace"}])},{default:c(()=>[F(L(e.content),1)]),_:2},1032,["style"]),_("div",j,[q,n(z,null,{default:c(()=>[F(L(e.time.toLocaleTimeString()),1)]),_:2},1024)])])]),_:2},1024)),[[S,e.content,"copy"],[S,()=>t(C).emit("toast","Copied"),"success"]]),e.from=="client"?(m(),h(x,{key:1,text:"From Local",location:"top"},{activator:c(({props:b})=>[n(v,k(b,{variant:"plain",icon:"mdi-arrow-top-left-thick"}),null,16)]),_:1})):B("",!0)]))),128))])}}});export{ee as default};
