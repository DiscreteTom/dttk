import{u as H}from"./useEmitter.43e253ae.js";import{d as M,z as P,r as u,f as r,C as R,l as w,m as _,q as n,E as t,G as k,H as U,N,s as c,O as $,F as q,D as G,k as m,K as g,P as I,I as h,L as F,J,v as L,t as B}from"./entry.c2e56329.js";const O={class:"d-flex flex-wrap"},W={class:"d-flex flex-wrap"},j={class:"d-flex flex-grow-1 align-end"},Q=_("div",{class:"flex-grow-1"},null,-1),ee=M({__name:"websocket",setup(X){const C=H(),y=P(),p=u("ws://localhost:8080"),f=u(""),a=u(!1),l=u(null),d=u(""),i=u([]);function E(){a.value=!0,l.value!=null&&l.value.close(),l.value=new WebSocket(p.value,f.value.split(",").map(s=>s.trim()).filter(s=>s!="")),l.value.onopen=()=>{a.value=!1,i.value.unshift({time:new Date,from:"system",type:"text",content:"Connected"})},l.value.onclose=()=>{l.value=null,a.value=!1,i.value.unshift({time:new Date,from:"system",type:"text",content:"Disconnected"})},l.value.onmessage=s=>{i.value.unshift({time:new Date,from:"server",type:"text",content:s.data})},l.value.onerror=s=>{l.value=null,a.value=!1,i.value.unshift({time:new Date,from:"system",type:"error",content:s.toString()})}}function V(){if(l.value==null){C.emit("toast","Not connected");return}l.value.send(d.value),i.value.unshift({time:new Date,from:"client",type:"text",content:d.value}),d.value=""}return(s,o)=>{const D=r("v-text-field"),v=r("v-btn"),b=r("v-tooltip"),K=r("v-textarea"),T=r("v-card-text"),z=r("v-card-subtitle"),A=r("v-card"),S=R("clipboard");return m(),w("div",null,[_("div",O,[n(D,{label:"Server URL",modelValue:t(p),"onUpdate:modelValue":o[0]||(o[0]=e=>k(p)?p.value=e:null),variant:"outlined",density:"compact",clearable:"","hide-details":"",placeholder:"ws://localhost:8080",disabled:t(a)||t(l)!=null,class:U(t(y).smAndUp.value?"mr-3":"mb-3"),style:N(t(y).smAndUp.value?"":"width:100%")},null,8,["modelValue","disabled","class","style"]),n(D,{label:"Subprotocols (optional, comma separated)",modelValue:t(f),"onUpdate:modelValue":o[1]||(o[1]=e=>k(f)?f.value=e:null),variant:"outlined",density:"compact",clearable:"","hide-details":"",placeholder:"ship, done",disabled:t(a)||t(l)!=null,class:U(t(y).smAndUp.value?"mr-3":"")},null,8,["modelValue","disabled","class"])]),n(v,{onClick:o[2]||(o[2]=e=>t(l)==null?E():t(l).close()),disabled:t(a),block:"",class:"my-2","prepend-icon":t(l)==null?"mdi-link-variant":"mdi-link-variant-off",text:t(l)==null?"Connect":"Disconnect",loading:t(a)},null,8,["disabled","prepend-icon","text","loading"]),n(K,{label:"",rows:"1",modelValue:t(d),"onUpdate:modelValue":o[3]||(o[3]=e=>k(d)?d.value=e:null),"auto-grow":"",variant:"outlined",density:"compact",clearable:"","hide-details":"",disabled:t(l)==null,onKeyup:$(I(V,["ctrl"]),["enter"]),placeholder:"Type message here"},{"append-inner":c(()=>[n(b,{text:"Send (Ctrl+Enter)",location:"top"},{activator:c(({props:e})=>[n(v,g(e,{icon:"mdi-send",variant:"plain",onClick:V}),null,16)]),_:1})]),_:1},8,["modelValue","disabled","onKeyup"]),n(v,{onClick:o[4]||(o[4]=e=>t(i).length=0),block:"",class:"my-2","prepend-icon":"mdi-delete-outline",text:"Clear History"}),(m(!0),w(q,null,G(t(i),e=>(m(),w("div",{key:e.time.getTime(),class:"my-2 d-flex"},[e.from=="server"||e.from=="system"?(m(),h(b,{key:0,text:e.from=="server"?"From Server":"From System",location:"top"},{activator:c(({props:x})=>[n(v,g(x,{variant:"plain",icon:e.from=="server"?"mdi-arrow-bottom-right-thick":"mdi-account"}),null,16,["icon"])]),_:2},1032,["text"])):F("",!0),J((m(),h(A,{class:"flex-grow-1",onClick:o[5]||(o[5]=()=>{})},{default:c(()=>[_("div",W,[n(T,{style:N([e.type=="error"?"color:red":void 0,{"word-break":"break-all","white-space":"pre","font-family":"monospace"}])},{default:c(()=>[L(B(e.content),1)]),_:2},1032,["style"]),_("div",j,[Q,n(z,null,{default:c(()=>[L(B(e.time.toLocaleTimeString()),1)]),_:2},1024)])])]),_:2},1024)),[[S,e.content,"copy"],[S,()=>t(C).emit("toast","Copied"),"success"]]),e.from=="client"?(m(),h(b,{key:1,text:"From Local",location:"top"},{activator:c(({props:x})=>[n(v,g(x,{variant:"plain",icon:"mdi-arrow-top-left-thick"}),null,16)]),_:1})):F("",!0)]))),128))])}}});export{ee as default};
