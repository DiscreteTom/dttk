import{u as M}from"./useEmitter.43e253ae.js";import{d as R,F as P,r as u,i as r,I as W,x as w,y,A as n,L as t,M as k,N as U,W as N,B as c,U as $,T as H,J as I,K as J,v as m,Q as g,O as h,R as B,P as O,C as F,z as L}from"./entry.8a845c13.js";const Q={class:"d-flex flex-wrap"},j={class:"d-flex flex-wrap"},q={class:"d-flex flex-grow-1 align-end"},G=y("div",{class:"flex-grow-1"},null,-1),ee=R({__name:"websocket",setup(X){const C=M(),_=P(),v=u("ws://localhost:8080"),f=u(""),a=u(!1),l=u(null),d=u(""),i=u([]);function T(){a.value=!0,l.value!=null&&l.value.close(),l.value=new WebSocket(v.value,f.value.split(",").map(s=>s.trim()).filter(s=>s!="")),l.value.onopen=()=>{a.value=!1,i.value.unshift({time:new Date,from:"system",type:"text",content:"Connected"})},l.value.onclose=()=>{l.value=null,a.value=!1,i.value.unshift({time:new Date,from:"system",type:"text",content:"Disconnected"})},l.value.onmessage=s=>{i.value.unshift({time:new Date,from:"server",type:"text",content:s.data})},l.value.onerror=s=>{l.value=null,a.value=!1,i.value.unshift({time:new Date,from:"system",type:"error",content:s.type})}}function V(){if(l.value==null){C.emit("toast","Not connected");return}l.value.send(d.value),i.value.unshift({time:new Date,from:"client",type:"text",content:d.value}),d.value=""}return(s,o)=>{const D=r("v-text-field"),p=r("v-btn"),b=r("v-tooltip"),A=r("v-textarea"),K=r("v-card-text"),z=r("v-card-subtitle"),E=r("v-card"),S=W("clipboard");return m(),w("div",null,[y("div",Q,[n(D,{label:"Server URL",modelValue:t(v),"onUpdate:modelValue":o[0]||(o[0]=e=>k(v)?v.value=e:null),variant:"outlined",density:"compact",clearable:"","hide-details":"",placeholder:"ws://localhost:8080",disabled:t(a)||t(l)!=null,class:U(t(_).smAndUp.value?"mr-3":"mb-3"),style:N(t(_).smAndUp.value?"":"width:100%")},null,8,["modelValue","disabled","class","style"]),n(D,{label:"Subprotocols (optional, comma separated)",modelValue:t(f),"onUpdate:modelValue":o[1]||(o[1]=e=>k(f)?f.value=e:null),variant:"outlined",density:"compact",clearable:"","hide-details":"",placeholder:"ship, done",disabled:t(a)||t(l)!=null,class:U(t(_).smAndUp.value?"mr-3":"")},null,8,["modelValue","disabled","class"])]),n(p,{onClick:o[2]||(o[2]=e=>t(l)==null?T():t(l).close()),disabled:t(a),block:"",class:"my-2","prepend-icon":t(l)==null?"mdi-link-variant":"mdi-link-variant-off",text:t(l)==null?"Connect":"Disconnect",loading:t(a)},null,8,["disabled","prepend-icon","text","loading"]),n(A,{label:"",rows:"1",modelValue:t(d),"onUpdate:modelValue":o[3]||(o[3]=e=>k(d)?d.value=e:null),"auto-grow":"",variant:"outlined",density:"compact",clearable:"","hide-details":"",disabled:t(l)==null,onKeyup:$(H(V,["ctrl"]),["enter"]),placeholder:"Type message here"},{"append-inner":c(()=>[n(b,{text:"Send (Ctrl+Enter)",location:"top"},{activator:c(({props:e})=>[n(p,g(e,{icon:"mdi-send",variant:"plain",onClick:V}),null,16)]),_:1})]),_:1},8,["modelValue","disabled","onKeyup"]),n(p,{onClick:o[4]||(o[4]=e=>t(i).length=0),block:"",class:"my-2","prepend-icon":"mdi-delete-outline",text:"Clear History"}),(m(!0),w(I,null,J(t(i),e=>(m(),w("div",{key:e.time.getTime(),class:"my-2 d-flex"},[e.from=="server"||e.from=="system"?(m(),h(b,{key:0,text:e.from=="server"?"From Server":"From System",location:"top"},{activator:c(({props:x})=>[n(p,g(x,{variant:"plain",icon:e.from=="server"?"mdi-arrow-bottom-right-thick":"mdi-robot-outline"}),null,16,["icon"])]),_:2},1032,["text"])):B("",!0),O((m(),h(E,{class:"flex-grow-1",onClick:o[5]||(o[5]=()=>{})},{default:c(()=>[y("div",j,[n(K,{style:N([e.type=="error"?"color:red":void 0,{"word-break":"break-all","white-space":"pre","font-family":"monospace"}])},{default:c(()=>[F(L(e.content),1)]),_:2},1032,["style"]),y("div",q,[G,n(z,null,{default:c(()=>[F(L(e.time.toLocaleTimeString()),1)]),_:2},1024)])])]),_:2},1024)),[[S,e.content,"copy"],[S,()=>t(C).emit("toast","Copied"),"success"]]),e.from=="client"?(m(),h(b,{key:1,text:"From Local",location:"top"},{activator:c(({props:x})=>[n(p,g(x,{variant:"plain",icon:"mdi-arrow-top-left-thick"}),null,16)]),_:1})):B("",!0)]))),128))])}}});export{ee as default};
